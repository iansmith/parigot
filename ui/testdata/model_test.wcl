@wcl 0.7.0
//
// Test for the basics of models
//
/////////////////// CSS /////////////////
// path is relative to this file
@css 
    +"../../static/css/bootstrap.css"
    +"../../static/css/bootstrap-grid.css"
/////////////////// PREAMBLE /////////////////
@preamble 
<<
    import(
        "google.golang.org/protobuf/types/known/anypb"
        queuemsg "github.com/iansmith/parigot/g/msg/queue/v1"
    )

>>

/////////////////// MODELS /////////////////


//----- queue -----
@model 
QueueModel "../../api/proto/msg/queue/v1/queue.proto","../../api/proto/msg/file/v1/file.proto"
//----- fleazil -----
FleazilModel "../../api/proto/msg/queue/v1/queue.proto","../../api/proto/msg/file/v1/file.proto"

@view
// ---- QueueMsgView ---
// xxx add test for :Quemodel with no qualifier
// xxx add test for :QueueModel.foo
// xxx add test for :QueueModel:foo:bar

// xxx add tests for bad mesg from model
// xxx add tests to amke sure . works but is not checked

QueueMsgView (a int64, model :QueueModel:QueueMsg) 
    <"h3"> << ${model} >>
    ( 
        <"h4"> <<some text before ${model:msg_id:id} and some text after>>
        <"h5"> <<${model.sent}>>
        <"h5"> <<${sizeInBytes(model:payload)}>>
    )


QueueViewShort (a int64, model :QueueModel:QueueMsg) 
 <"h3"> <<${model:id}:${model.msg_id}>>


///////////////// TEXT FUNC GLOBAL /////////////////

@text 
sizeInBytes(p pb.Any)
@local(size int)
@pre
<<
    ${size}=len(p.Value)
>>
<<${size} bytes>>

shortModel(model :QueueModel:QueueMsg)
    <<${model:id}:${model:msg_id}:${sizeInBytes(model.Payload)}>>

///////////////// DOC FUNC GLOBAL /////////////////

///////////////// EVENT GLOBAL /////////////////
